# Raman-Monte-Carlo
A program built atop the MCX infrastructure that uses the custom isoweight function to effectively simulate Raman scattering. 

The isoweight function is a new launch function that takes the excitation matrix, rasterizes it, cummulatively sums and normalizes to 1, and then uses the random number generation to query this line. 

In the second step, the subsequent photon emission process is implemented as a 3D volumetric light source, accelerated by using an inverse distribution method (IDM) based on the excitation fluence map. Specifically, a normalized excitation fluence distribution, obtained from the above step (Figure 2a), can be interpreted as the probability density function (PDF) of photons within the 3D domain. This 3D PDF is then serialized into a 1D vector, with each value representing a normalized fluence value in a given voxel. We also store the corresponding voxel index (as a 1D linear index) alongside with the 1D PDF. From this 1D PDF, we can compute the cumulative density function, or CDF, by numerically integrating the PDF. The normalized cumulative flux vs. volume index is then inverted, to create a mapping (Figure 2c) between a uniform 0-1 distributed random variable to the linear index of the voxel from which to launch the new emission photon. This procedure is implemented in MCX as a left-side binary search. The binary search algorithm is known for its speed, and when implemented on the GPU, dramatically increases the computational efficiency of emission photon generation.

This code is very much based on the open-source MCX project by Qianqian Fang, whcih can be downloaded at https://sourceforge.net/projects/mcx/. I would like to thank Dr. Qianqian Fang and his team for providing such great code to build upon. 
